angular.module("mwPortal",["ngRoute","ngAnimate","mwUI","mwPortal.Start","mwPortal.Hero","mwPortal.SuperPower","mwPortal.Main"]),angular.module("mwPortal.Main",[]).config(["i18nProvider",function(a){a.addLocale("de_DE","Deutsch","de_DE.json"),a.addLocale("en_US","English (US)","en_US.json"),a.addResource("app/modules/main/i18n")}]).config(["ResponseToastHandlerProvider",function(a){a.registerToastType("info",{type:"primary",autoHide:!0,autoHideTime:3e3,icon:"fa-info-circle"}),a.registerToastType("success",{type:"success",autoHide:!0,icon:"fa-check-circle-o"}),a.registerToastType("error",{type:"danger",autoHide:!1,icon:"fa-times-circle"}),a.registerToast("*",{singular:"main.toasts.serverResponses.error.resourceNotFound.singular",plural:"main.toasts.serverResponses.error.resourceNotFound.plural"},{methods:["GET"],statusCodes:[404],toastType:"info"}),a.registerToast("*",{singular:"main.toasts.serverResponses.error.unknown"},{methods:["GET","POST","PUT","DELETE"],onError:!0,toastType:"error",preProcess:function(a,b,c,d){return d.statusText?c.get(a,{reason:d.statusText}):c.get(a,{reason:"Unknown"})}}),a.registerToast("*",{singular:"main.toasts.serverResponses.error.serverCouldNotBeReached.singular"},{methods:["GET","POST","PUT","DELETE"],statusCodes:[-1],toastType:"info"}),a.registerSuccessToast("*",{singular:"main.toasts.serverResponses.success.created.singular",plural:"main.toasts.serverResponses.success.created.plural"},"POST","success"),a.registerSuccessToast("*",{singular:"main.toasts.serverResponses.success.updated.singular",plural:"main.toasts.serverResponses.success.updated.plural"},"PUT","success"),a.registerSuccessToast("*",{singular:"main.toasts.serverResponses.success.deleted.singular",plural:"main.toasts.serverResponses.success.deleted.plural"},"DELETE","success")}]).config(["exceptionHandlerModalProvider",function(a){a.setModalOptions({successCallback:"jsExceptionOkHandler",errorCallback:"jsExceptionCancelHandler",displayException:!0})}]).run(["i18n",function(a){var b=window.navigator.language||window.navigator.browserLanguage,c=window.localStorage.getItem("locale");c?a.setLocale(c.replace(/"/g,"")):b.indexOf("de")>-1?a.setLocale("de_DE"):a.setLocale("en_US")}]).run(["$timeout","Toast","i18n",function(a,b,c){var d,e=function(){a(function(){navigator.onLine?d&&(b.removeToast(d.id),d=null):d=b.addToast(c.get("main.toasts.offline.body"),{title:c.get("main.toasts.offline.title"),type:"primary",icon:"fa-wifi",autoHide:!1})})};window.addEventListener("online",e),window.addEventListener("offline",e)}]).run(["$timeout","Toast","i18n",function(a,b,c){var d=window.applicationCache,e=function(){a(function(){b.addToast(c.get("main.toasts.newPortalVersion.body"),{title:c.get("main.toasts.newPortalVersion.title"),type:"primary",autoHide:!1,button:{title:c.get("main.toasts.newPortalVersion.action"),action:function(){document.location.reload()},isLink:!0}})})};d.addEventListener("updateready",e,!1),window.setInterval(function(){1===d.status&&d.update()},9e5)}]),angular.module("mwPortal.Main").config(["$routeProvider",function(a){a.when("/not-found",{templateUrl:"app/modules/main/templates/not-found.template.html",controller:"MainNotFoundController",controllerAs:"ctrl",cssClasses:"main not-found"}).when("/",{redirectTo:"/start"}).otherwise({redirectTo:"/not-found"})}]),angular.module("mwPortal.Main").service("MwPortalCollection",function(){return mwUI.Backbone.Collection.extend({hostName:function(){return"PRODUCTION"===window.CONFIG.env?"http://52.59.202.190:3000":""},basePath:"/api",parse:function(a){return a.data}})}),angular.module("mwPortal.Main").service("MwPortalModel",function(){return mwUI.Backbone.Model.extend({hostName:function(){return"PRODUCTION"===window.CONFIG.env?"http://52.59.202.190:3000":""},basePath:"/api",parse:function(a){return a.data||a}})}),angular.module("mwPortal.Main").controller("MainController",["i18n",function(a){this.locales=a.getLocales(),this.setLocale=function(b){a.setLocale(b),window.localStorage.setItem("locale",b)},this.getCurrentYear=function(){return(new Date).getFullYear()},this.getAppversion=function(){return window.CONFIG.version}}]),angular.module("mwPortal.Main").controller("MainNotFoundController",function(){}),angular.module("mwPortal.Main").service("jsExceptionOkHandler",["$q","$timeout","$rootScope","$location",function(a,b,c,d){return function(e){var f=a.defer();return b(function(){console.log(e),f.resolve()},300),c.$on("$modalCloseSuccess",function(){console.info("Restarting the application..."),d.path("/")}),f.promise}}]).service("jsExceptionCancelHandler",["$location",function(a){return function(){console.info("Restarting the application..."),a.path("/")}}]),angular.module("mwPortal.Start",[]).config(["i18nProvider",function(a){a.addResource("app/modules/start/i18n")}]),angular.module("mwPortal.Start").config(["$routeProvider",function(a){a.when("/start",{templateUrl:"app/modules/start/templates/index.template.html",controller:"StartIndexController",controllerAs:"ctrl",cssClasses:"start index"})}]),angular.module("mwPortal.Start").directive("backboneSelectable",["MwPortalCollection",function(a){return{scope:{},templateUrl:"app/modules/start/directives/backbone-module/backbone-selectable/backbone-selectable.template.html",link:function(b){b.mwPortalCollection=new a;for(var c=0;c<5;c++)b.mwPortalCollection.add({id:c,name:"Item "+(c+1)})}}}]),angular.module("mwPortal.Start").directive("backboneSelectableWithOptions",["MwPortalModel","MwPortalCollection",function(a,b){return{scope:{isSingleSelection:"=",disabledItems:"=",preSelectedItems:"="},templateUrl:"app/modules/start/directives/backbone-module/backbone-selectable/backbone-selectable-with-options.template.html",link:function(c){var d,e=a.extend({selectableOptions:function(){return{isDisabled:function(){return!!_.isArray(c.disabledItems)&&c.disabledItems.indexOf(this.get("id"))>=0}}}}),f=b.extend({model:e,selectableOptions:function(){return{isSingleSelection:c.isSingleSelection,preSelected:d}}});c.preSelectedItems&&(d=new b,c.preSelectedItems.forEach(function(a){d.add({id:a})})),c.mwPortalCollection=new f;for(var g=0;g<5;g++)c.mwPortalCollection.add({id:g,name:"Item "+(g+1)})}}}]),angular.module("mwPortal.Start").directive("inputWrapper",function(){return{scope:{},templateUrl:"app/modules/start/directives/form-module/input-wrapper/input-wrapper.template.html",link:function(a){a.model=new mwUI.Backbone.Model}}}),angular.module("mwPortal.Start").directive("customFormValidations",function(){return{scope:{},templateUrl:"app/modules/start/directives/form-module/custom-form-validations/custom-form-validations.template.html",link:function(a){a.model=new mwUI.Backbone.Model}}}),angular.module("mwPortal.Start").config(["mwValidationMessagesProvider",function(a){a.registerValidator("syncValidation","start.formModuleDirectives.customFormValidations.validationError")}]).directive("syncCustomValidation",["mwValidationMessages","i18n",function(a,b){return{require:"ngModel",scope:{matchValue:"@"},link:function(c,d,e,f){f.$validators.syncValidation=function(a){return a!==c.matchValue},c.$watch("matchValue",function(c){a.updateMessage("syncValidation",function(){return b.get("start.formModuleDirectives.customFormValidations.validationError",{value:c})}),f.$validate()})}}}]),angular.module("mwPortal.Start").config(["mwValidationMessagesProvider",function(a){a.registerValidator("asyncValidation","start.formModuleDirectives.customFormValidations.validationError")}]).directive("asyncCustomValidation",["$q","$timeout","mwValidationMessages","i18n",function(a,b,c,d){return{require:"ngModel",scope:{matchValues:"="},link:function(e,f,g,h){var i=function(a){return-1!==e.matchValues.indexOf(a)},j=function(c){var d=a.defer();return b(function(){return i(c)?d.reject(c):d.resolve()},500),d.promise};h.$asyncValidators.asyncValidation=function(b){return j(b).then(null,function(b){return c.updateMessage("asyncValidation",function(){return d.get("start.formModuleDirectives.customFormValidations.validationError",{value:b})}),a.reject()})},e.$watch("matchValues",function(){h.$validate()})}}}]),angular.module("mwPortal.Start").directive("formAction",["$q","$timeout","Toast",function(a,b,c){return{scope:{},templateUrl:"app/modules/start/directives/form-module/form-action/form-action.template.html",link:function(d){var e=mwUI.Backbone.Model.extend({defaults:function(){return{mwRequiredInputWrapper:"Xyz",mwErrorInputWrapper:null}}}),f=function(){var c=a.defer();return b(function(){console.log("Model was mocked saved!",d.model.toJSON()),c.resolve()},500),c.promise};d.cancel=function(){d.model.set(d.model.defaults())},d.save=function(){return f().then(function(){c.addToast(d.model.get("mwRequiredInputWrapper")+" was saved!",{autoHide:!0})})},d.model=new e}}}]),angular.module("mwPortal.Start").controller("StartIndexController",function(){this.name="Mw Uikit"}),angular.module("mwPortal.Hero",[]).config(["i18nProvider",function(a){a.addResource("app/modules/hero/i18n")}]).config(["ResponseToastHandlerProvider",function(a){a.registerSuccessToast("/api/heroes",{singular:"hero.toasts.serverResponses.success.created.singular",plural:"hero.toasts.serverResponses.success.created.plural"},"POST","success"),a.registerSuccessToast("/api/heroes/*",{singular:"hero.toasts.serverResponses.success.updated.singular",plural:"hero.toasts.serverResponses.success.updated.plural"},"PUT","success"),a.registerSuccessToast("/api/heroes/*",{singular:"hero.toasts.serverResponses.success.deleted.singular",plural:"hero.toasts.serverResponses.success.deleted.plural"},"DELETE","success")}]),angular.module("mwPortal.Hero").config(["$routeProvider","$injector",function(a,b){a.when("/heroes",{templateUrl:"app/modules/hero/templates/index.template.html",controller:"HeroIndexController",controllerAs:"ctrl",cssClasses:"hero index",resolve:b.get("HeroIndexControllerResolver")}).when("/heroes/new",{templateUrl:"app/modules/hero/templates/new.template.html",controller:"HeroFormController",controllerAs:"ctrl",cssClasses:"hero form new",resolve:b.get("HeroFormControllerResolver")}).when("/heroes/:heroId/edit",{templateUrl:"app/modules/hero/templates/edit.template.html",controller:"HeroFormController",controllerAs:"ctrl",cssClasses:"hero form edit",resolve:b.get("HeroFormControllerResolver")})}]),angular.module("mwPortal.Hero").service("HeroModel",["MwPortalModel","SuperPowerModel","SuperPowersCollection",function(a,b,c){return a.extend({endpoint:"/heroes",nested:function(){return{superPowers:c,strongestSuperPower:b}},hasSuperPower:function(a){return!!this.get("superPowers").get(a)}})}]),angular.module("mwPortal.Hero").service("HeroesCollection",["MwPortalCollection","HeroModel",function(a,b){return a.extend({endpoint:"/heroes",model:b,findByNameCaseInSensitive:function(a){return a=a.toLowerCase(),this.find(function(b){return b.get("name").toLowerCase()===a})}})}]),angular.module("mwPortal.Hero").controller("HeroIndexController",["HeroDeleteConfirmModal","heroes",function(a,b){var c=new a;this.heroes=b,this.showDeleteConfirmModal=function(){c.setScopeAttributes({selected:this.heroes.selectable.getSelected()}),c.show()}}]).constant("HeroIndexControllerResolver",{heroes:["HeroesCollection",function(a){return(new a).fetch()}]}),angular.module("mwPortal.Hero").controller("HeroFormController",["$location","hero",function(a,b){this.hero=b,this.goBack=function(){a.path("/heroes")},this.save=function(){return this.hero.save().then(function(){this.goBack()}.bind(this))},this.cancel=function(){this.goBack()}}]).constant("HeroFormControllerResolver",{hero:["$route","HeroModel",function(a,b){return a.current.params.heroId?new b({id:a.current.params.heroId}).fetch():new b}]}),angular.module("mwPortal.Hero").config(["mwValidationMessagesProvider",function(a){a.registerValidator("heroUnique","hero.validators.notUnique")}]).directive("heroValidateUnique",["i18n","mwValidationMessages","HeroesCollection",function(a,b,c){return{require:"ngModel",scope:{validate:"=heroValidateUnique"},link:function(d,e,f,g){var h=new c,i=function(a){return a&&a.length&&(angular.isUndefined(d.validate)||d.validate)};g.$validators.heroUnique=function(c){if(i(c)){var d=h.findByNameCaseInSensitive(c);return d&&b.updateMessage("heroUnique",function(){return a.get("hero.validators.notUnique",{name:c})}),!d}return!0},h.fetch().then(function(){g.$validate()})}}}]),angular.module("mwPortal.Hero").service("HeroDeleteConfirmModal",["Modal",function(a){return a.prepare({templateUrl:"app/modules/hero/modals/templates/hero-delete-confirm.modal.template.html",controller:"HeroDeleteConfirmModalController",controllerAs:"ctrl"})}]).controller("HeroDeleteConfirmModalController",function(){this.deleteSelected=function(){this.selected.secureEach(function(a){a.destroy()})}}),angular.module("mwPortal.SuperPower",[]).config(["i18nProvider",function(a){a.addResource("app/modules/super-power/i18n")}]).config(["ResponseToastHandlerProvider",function(a){a.registerSuccessToast("/api/super-powers",{singular:"superPower.toasts.serverResponses.success.created.singular",plural:"superPower.toasts.serverResponses.success.created.plural"},"POST","success"),a.registerSuccessToast("/api/super-powers/*",{singular:"superPower.toasts.serverResponses.success.updated.singular",plural:"superPower.toasts.serverResponses.success.updated.plural"},"PUT","success"),a.registerSuccessToast("/api/super-powers/*",{singular:"superPower.toasts.serverResponses.success.deleted.singular",plural:"superPower.toasts.serverResponses.success.deleted.plural"},"DELETE","success")}]),angular.module("mwPortal.SuperPower").config(["$routeProvider","$injector",function(a,b){a.when("/super-powers",{templateUrl:"app/modules/super-power/templates/index.template.html",controller:"SuperPowerIndexController",controllerAs:"ctrl",cssClasses:"super-power index",resolve:b.get("SuperPowerIndexControllerResolver")}).when("/super-powers/new",{templateUrl:"app/modules/super-power/templates/new.template.html",controller:"SuperPowerFormController",controllerAs:"ctrl",cssClasses:"super-power form new",resolve:b.get("SuperPowerFormControllerResolver")}).when("/super-powers/:superPowerId/edit",{templateUrl:"app/modules/super-power/templates/edit.template.html",controller:"SuperPowerFormController",controllerAs:"ctrl",cssClasses:"super-power form edit",resolve:b.get("SuperPowerFormControllerResolver")})}]),angular.module("mwPortal.SuperPower").service("SuperPowerModel",["MwPortalModel",function(a){return a.extend({endpoint:"/super-powers"})}]),angular.module("mwPortal.SuperPower").service("SuperPowersCollection",["MwPortalCollection","SuperPowerModel",function(a,b){return a.extend({endpoint:"/super-powers",model:b})}]),angular.module("mwPortal.SuperPower").controller("SuperPowerIndexController",["SuperPowerDeleteConfirmModal","HeroesCollection","superPowers",function(a,b,c){var d=new a,e=new b;this.superPowers=c,this.showDeleteConfirmModal=function(){d.setScopeAttributes({selected:this.superPowers.selectable.getSelected()}),d.show()},this.canDeleteSuperPower=function(a){var b=!0;return e.each(function(c){b&&(b=!c.hasSuperPower(a))}),b},this.canDeleteSelectedSuperPowers=function(){var a=!0;return this.superPowers.selectable.getSelected().each(function(b){a&&(a=this.canDeleteSuperPower(b))}.bind(this)),a},e.fetch()}]).constant("SuperPowerIndexControllerResolver",{superPowers:["SuperPowersCollection",function(a){return(new a).fetch()}]}),angular.module("mwPortal.SuperPower").controller("SuperPowerFormController",["$location","SuperPowersCollection","superPower",function(a,b,c){this.superPower=c,this.goBack=function(){a.path("/super-powers")},this.save=function(){return this.superPower.save().then(function(){this.goBack()}.bind(this))},this.cancel=function(){this.goBack()}}]).constant("SuperPowerFormControllerResolver",{superPower:["$route","SuperPowerModel",function(a,b){return a.current.params.superPowerId?new b({id:a.current.params.superPowerId}).fetch():new b}]}),angular.module("mwPortal.SuperPower").directive("superPowerSelectorBtn",["MwPortalModel","SuperPowerSelectorModal",function(a,b){return{scope:{selected:"=",enabledSuperpowers:"=",mwRequired:"=",mwDisabled:"="},templateUrl:"app/modules/super-power/directives/templates/super-power-selector.directive.template.html",link:function(c){var d=new b;c.openSuperPowerSelectorModal=function(){d.setScopeAttributes({selected:c.selected,enabledSuperpowers:c.enabledSuperpowers}),d.show()},c.selectedIsModel=function(){return c.selected instanceof a}}}}]),angular.module("mwPortal.SuperPower").service("SuperPowerDeleteConfirmModal",["Modal",function(a){return a.prepare({templateUrl:"app/modules/super-power/modals/templates/super-power-delete-confirm.modal.template.html",controller:"SuperPowerDeleteConfirmModalController",controllerAs:"ctrl"})}]).controller("SuperPowerDeleteConfirmModalController",function(){this.deleteSelected=function(){this.selected.secureEach(function(a){a.destroy()})}}),angular.module("mwPortal.SuperPower").service("SuperPowerSelectorModal",["Modal",function(a){return a.prepare({templateUrl:"app/modules/super-power/modals/templates/super-power-selector.modal.template.html",controller:"SuperPowerSelectorModalController",controllerAs:"ctrl"})}]).controller("SuperPowerSelectorModalController",["SuperPowerModel","SuperPowersCollection",function(a,b){var c=this,d=a.extend({selectableOptions:function(){return{isDisabled:function(){return!!(c.enabledSuperpowers&&c.enabledSuperpowers.length>0)&&!c.enabledSuperpowers.get(this)}}}}),e=b.extend({model:d,selectableOptions:function(){return{preSelected:c.selected}}});this.superPowers=new e,this.save=function(){this.superPowers.selectable.isSingleSelection()?this.superPowers.selectable.isSingleSelection()&&(this.superPowers.selectable.getSelected().first()?this.selected.set(this.superPowers.selectable.getSelected().first().toJSON()):this.selected.clear()):this.selected.replace(this.superPowers.selectable.getSelected().toJSON()),this.hideModal()},this.superPowers.fetch()}]);